
car_data = LOAD '/user/maria_dev/car.csv' USING PigStorage(',') AS (
    CarName: chararray,
    Year: int,
    Region: chararray,
    FuelType: chararray,
    Mileage: int,
    Price: float
);


formatted_data = FOREACH car_data GENERATE
    CONCAT(CONCAT('row', CarName), '_', (chararray)Year) AS row_key,
    'info:CarName' as info_cf1,
    CarName,
    'info:Year' as info_cf2,
    (chararray)Year,
    'info:Region' as info_cf3,
    Region,
    'details:FuelType' as details_cf1,
    FuelType,
    'details:Mileage' as details_cf2,
    (chararray)Mileage,
    'details:Price' as details_cf3,
    (chararray)Price;


STORE formatted_data INTO 'hbase://car_price' USING org.apache.pig.backend.hadoop.hbase.HBaseStorage(
    'info:CarName,info:Year,info:Region,details:FuelType,details:Mileage,details:Price'
);
